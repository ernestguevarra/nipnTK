<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distributions of variables and indices • nipnTK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Distributions of variables and indices">
<meta property="og:description" content="nipnTK">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-155098215-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155098215-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nipnTK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/nipnTK.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rl.html">Check ranges and legal values</a>
    </li>
    <li>
      <a href="../articles/sp.html">Identify outliers using scatterplots</a>
    </li>
    <li>
      <a href="../articles/flagging.html">Identify outliers using flags</a>
    </li>
    <li>
      <a href="../articles/ad.html">Assess distributions of variables and indices</a>
    </li>
    <li>
      <a href="../articles/dp.html">Assess digit preference</a>
    </li>
    <li>
      <a href="../articles/ah.html">Assess age heaping</a>
    </li>
    <li>
      <a href="../articles/sr.html">Assess sex ratio</a>
    </li>
    <li>
      <a href="../articles/as.html">Assess age and sex distributions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/ernestguevarra">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/ernestguevarra/">
    <span class="fab fa fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/nutriverse/nipnTK/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ad_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Distributions of variables and indices</h1>
                        <h4 class="author">Mark Myatt</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nutriverse/nipnTK/blob/master/vignettes/ad.Rmd"><code>vignettes/ad.Rmd</code></a></small>
      <div class="hidden name"><code>ad.Rmd</code></div>

    </div>

    
    
<div id="assessing-the-distribution-of-anthropometric-variables-indices-and-indicators" class="section level2">
<h2 class="hasAnchor">
<a href="#assessing-the-distribution-of-anthropometric-variables-indices-and-indicators" class="anchor"></a>Assessing the distribution of anthropometric variables, indices, and indicators</h2>
<p>In this section we will examine the distribution of anthropometric variables (e.g. weight, height, and MUAC), anthropometric indices (e.g. WHZ, HAZ, and WHZ), and anthropometric indicators (e.g. wasted, stunted, and underweight).</p>
<p>Topics such as the distribution of age, age by sex, age-heaping, and digit preference are covered in other sections of this toolkit.</p>
<p>We will retrieve a survey dataset:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">svy &lt;- read.table("dist.ex01.csv", header = TRUE, sep = ",") head(svy)</pre></body></html></div>
<p>The file <strong>dist.ex01.csv</strong> is a comma-separated-value (CSV) file containing anthropometric data from a SMART survey in Kabul, Afghanistan.</p>
</div>
<div id="numerical-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#numerical-summaries" class="anchor"></a>Numerical summaries</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function in R provides a six-figure summary (i.e. minimum, first quartile, median, means, third quartile, and maximum) of a numeric variable. For example:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;    4.90    9.00   11.00   11.13   13.10   20.70</code></pre>
<p>The six-figure summary does not report the standard deviation.</p>
<p>The <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> function in R calculates the standard deviation. For example:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; [1] 2.802065</code></pre>
<p>The <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code> function may return <strong>NA</strong>. This will happen if there are missing values in the specified variable.</p>
<p>If this happens you can instruct the function to ignore missing values:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">svy</span>$<span class="no">weight</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>returns the same value:</p>
<pre><code>#&gt; [1] 2.802065</code></pre>
<p>Using the <code>na.rm</code> parameter in this way (i.e. specifying <code>na.rm = TRUE</code>) works with many descriptive functions in R (see table below).</p>
<table class="table table">
<caption>
Some descriptive functions in R
</caption>
<thead><tr>
<th style="text-align:left;">
Function*
</th>
<th style="text-align:left;">
Returns
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-family: monospace;">
mean()
</td>
<td style="text-align:left;">
Mean of the specified variables
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
sd()
</td>
<td style="text-align:left;">
Standard deviation of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
var()
</td>
<td style="text-align:left;">
Variance of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
median()
</td>
<td style="text-align:left;">
Median of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
min()
</td>
<td style="text-align:left;">
Minimum of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
max()
</td>
<td style="text-align:left;">
Maximum of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
range()
</td>
<td style="text-align:left;">
Range of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
IQR()
</td>
<td style="text-align:left;">
Interquartile range of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
quantile()
</td>
<td style="text-align:left;">
Quantiles of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
summary()
</td>
<td style="text-align:left;">
Six-figure summary of the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
mad()
</td>
<td style="text-align:left;">
Adjusted median absolute deviation
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
length()
</td>
<td style="text-align:left;">
Number of observations in the specified variable
</td>
</tr>
<tr>
<td style="text-align:left;font-family: monospace;">
nrow()
</td>
<td style="text-align:left;">
Number of rows in a data.frame (dataset)
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>*</sup> If a function returns NA this may be because the variable contains missing values. <br> Use na.rm = TRUE to instruct the function to ignore missing values.
</td>
</tr></tfoot>
</table>
</div>
<div id="graphical-and-numerical-summaries" class="section level2">
<h2 class="hasAnchor">
<a href="#graphical-and-numerical-summaries" class="anchor"></a>Graphical and numerical summaries</h2>
<p>Numerical summaries are useful for checking that data are within an expected range.</p>
<p>Graphical methods are often more informative than numerical summaries.</p>
<p>A key graphical method for examining the distribution of a variable is the histogram. For example:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">weight</span>)</pre></body></html></div>
<p>displays a histogram of the weight variable in the example dataset (see figure below).</p>
<p><img src="ad_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>We need to be careful when examining the distribution of measurements, as they may vary by sex. For example:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">height</span>)</pre></body></html></div>
<p>will display the heights of both males and females. That is, it will display two separate distributions as if they were a single distribution.</p>
<p><img src="ad_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>In this case it is sensible to look at the data for males and the data for females using separate histograms:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">height</span>[<span class="no">svy</span>$<span class="no">sex</span> <span class="kw">==</span> <span class="fl">1</span>])
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">height</span>[<span class="no">svy</span>$<span class="no">sex</span> <span class="kw">==</span> <span class="fl">2</span>])</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-15-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-15-2.png" width="50%"></p>
<p>or using a box-plot:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span>(<span class="no">svy</span>$<span class="no">height</span> ~ <span class="no">svy</span>$<span class="no">sex</span>, <span class="kw">names</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"M"</span>, <span class="st">"F"</span>),
        <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"Sex"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Height (cm)"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Height by sex"</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-16-1.png" width="50%" style="display: block; margin: auto;"></p>
<p>Numerical summaries can also be used:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span>(<span class="no">svy</span>$<span class="no">height</span>, <span class="no">svy</span>$<span class="no">sex</span>, <span class="no">summary</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt; svy$sex: 1
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   56.20   75.00   81.95   82.49   90.00  110.50 
#&gt; ------------------------------------------------------------ 
#&gt; svy$sex: 2
#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;   58.00   73.25   80.30   81.30   88.95  109.50</code></pre>
</div>
<div id="normal-distributions" class="section level2">
<h2 class="hasAnchor">
<a href="#normal-distributions" class="anchor"></a>Normal distributions</h2>
<p>With anthropometric variables and indices we usually expect a symmetrical (or nearly symmetrical) “bell-shaped” distribution. The variables and indices of interest are usually:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">muac</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">waz</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p>These plots are shown below.</p>
<p><img src="ad_files/figure-html/unnamed-chunk-20-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-20-2.png" width="50%"></p>
<div class="figure">
<img src="ad_files/figure-html/unnamed-chunk-21-1.png" alt="Histograms showing the distribution of anthropometric indices in the example dataset" width="50%"><img src="ad_files/figure-html/unnamed-chunk-21-2.png" alt="Histograms showing the distribution of anthropometric indices in the example dataset" width="50%"><p class="caption">
Histograms showing the distribution of anthropometric indices in the example dataset
</p>
</div>
<p>The number and size of the “intervals” (<code>breaks</code>) used when plotting a histogram is calculated to produce a useful plot. The intervals used are based on the range of the data.</p>
<p>You can specify a different set of <code>breaks</code> for the <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> function to use. For example:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">haz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="st">"scott"</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>calculates intervals using the standard deviation and the sample size. This:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">haz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="st">"FD"</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-23-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>calculates intervals using the inter-quartile range. This:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">haz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">40</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>will use about <strong>40</strong> intervals. This:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">svy</span>$<span class="no">haz</span>,
     <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)), <span class="kw">to</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)), <span class="kw">by</span> <span class="kw">=</span> <span class="fl">0.5</span>))</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-25-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>uses intervals that are <strong>0.5</strong> z-scores wide over the full range of <strong>haz</strong>.</p>
<p>All of these plots show nearly symmetrical “bell-shaped” distributions.</p>
<p>The ideal symmetrical “bell-shaped” distribution is the normal distribution.</p>
<p>There are a number of ways of assessing whether a variable is normally distributed.</p>
<p>The first way of assessing whether a variable is normally distributed is a simple “by-eye” assessment as we have already done using histograms.</p>
<p>The NiPN data quality toolkit provides an R language function called <code><a href="../reference/histNormal.html">histNormal()</a></code> that can help with “by-eye” assessments by superimposing a normal curve on a histogram of the variable of interest:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">muac</span>)
<span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)
<span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">waz</span>)
<span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p>These plots are shown below. All variables appear to be approximately normally distributed.</p>
<p><img src="ad_files/figure-html/unnamed-chunk-27-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-27-2.png" width="50%"></p>
<div class="figure">
<img src="ad_files/figure-html/unnamed-chunk-28-1.png" alt="Histograms of anthropometric indices with normal curves superimposed" width="50%"><img src="ad_files/figure-html/unnamed-chunk-28-2.png" alt="Histograms of anthropometric indices with normal curves superimposed" width="50%"><p class="caption">
Histograms of anthropometric indices with normal curves superimposed
</p>
</div>
<p>Changing the <code>breaks</code> parameter may make a histogram easier to “read”. For example:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">haz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="fl">15</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Another graphical method for assessing whether a variable is normally distributed is the <em>normal quantile-quantile plot</em>. These are easy to produce using <em>R</em>.</p>
<p>The NiPN data quality toolkit provided a helper function called <code><a href="../reference/qqNormalPlot.html">qqNormalPlot()</a></code> that produces a slightly enhanced normal quantile-quantile plot:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>This plot is shown below (with annotations). In this example the tails of the distribution contain more cases than would be expected in a perfectly normally distributed variable.</p>
<div class="figure" style="text-align: center">
<img src="../man/figures/qqNormalPlot.png" alt="Annotated normal quantile-quantile plot of the whz variable in the example dataset" width="70%"><p class="caption">
Annotated normal quantile-quantile plot of the whz variable in the example dataset
</p>
</div>
<p>We should examine all of the relevant variables:</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">svy</span>$<span class="no">muac</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">svy</span>$<span class="no">waz</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p>These plots are shown below. There is evidence of small deviations from normality in <strong>muac</strong>, <strong>haz</strong>, and <strong>whz</strong>.</p>
<p><img src="ad_files/figure-html/unnamed-chunk-32-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-32-2.png" width="50%"></p>
<div class="figure">
<img src="ad_files/figure-html/unnamed-chunk-33-1.png" alt="Normal quantile-quantile plots of anthropometric indices in the example dataset" width="50%"><img src="ad_files/figure-html/unnamed-chunk-33-2.png" alt="Normal quantile-quantile plots of anthropometric indices in the example dataset" width="50%"><p class="caption">
Normal quantile-quantile plots of anthropometric indices in the example dataset
</p>
</div>
<p>A final way of assessing normality is to use a formal statistical significance test. The preferred test is the <em>Shapiro-Wilk test of normality</em>:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">svy</span>$<span class="no">muac</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  svy$muac</span>
<span class="co">#&gt; W = 0.99496, p-value = 0.005495</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  svy$haz</span>
<span class="co">#&gt; W = 0.99348, p-value = 0.0007455</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">svy</span>$<span class="no">waz</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  svy$waz</span>
<span class="co">#&gt; W = 0.99827, p-value = 0.5358</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  svy$whz</span>
<span class="co">#&gt; W = 0.99078, p-value = 2.777e-05</span></pre></body></html></div>
<p>These tests indicate that <strong>muac</strong>, <strong>haz</strong>, and <strong>whz</strong> are significantly non-normal. Examination of the histograms and the normal quantile-quantile plots show that the deviation from normality in these indices are not particular marked. All indices have symmetrical, or nearly symmetrical, “bell-shaped” distributions.</p>
<p>We need to be careful when using significance tests such as the Shapiro-Wilk test of normality because the results can be strongly influenced by the sample size.</p>
<p>Small sample sizes can lead to tests missing large effects and large sample sizes can lead to tests identifying small effects as highly significant.</p>
<p>The analysis above found some highly significant but small deviations from normality that would probably not have been detected by a significance test if a smaller sample size had been used.</p>
<p>We can simulate a considerably smaller sample size by taking, for example, every fourth <strong>muac</strong> value:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">svy</span>$<span class="no">muac</span>)
<span class="co">#&gt; [1] 873</span>
<span class="no">oneQuarter</span> <span class="kw">&lt;-</span> <span class="no">svy</span>$<span class="no">muac</span>[<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">to</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">svy</span>$<span class="no">muac</span>), <span class="kw">by</span> <span class="kw">=</span> <span class="fl">4</span>)]
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">oneQuarter</span>)
<span class="co">#&gt; [1] 219</span></pre></body></html></div>
<p>Inspecting this smaller sample graphically:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">oneQuarter</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">oneQuarter</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-37-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-37-2.png" width="50%"></p>
<p>yields results similar to those found when the complete sample was used, but the formal test:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">oneQuarter</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Shapiro-Wilk normality test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  oneQuarter</span>
<span class="co">#&gt; W = 0.98836, p-value = 0.0724</span></pre></body></html></div>
<p>is no longer significant at <em>p &lt; 0.05</em>.</p>
<p>If a distribution appears to be normal (i.e. has a symmetrical, or nearly symmetrical, “bell-shaped” distribution) then it is usually safe to assume normality and to use statistical procedures that assume normality. Formal tests for normality can be misleading when sample sizes of more than a few hundred cases are used. Graphical methods are not very useful when sample sizes are small. Formal test are not very useful when sample sizes are large. The sample sizes of most anthropometry surveys will be large enough to cause formal tests for normality to identify small deviations from normality as highly significant.</p>
</div>
<div id="skew-and-kurtosis" class="section level2">
<h2 class="hasAnchor">
<a href="#skew-and-kurtosis" class="anchor"></a>Skew and kurtosis</h2>
<p>Skew is a measure of the asymmetry of a distribution about its mean. Skew can be zero, positive, or negative. Zero skew is found when the distribution is perfectly symmetrical. Positive skew is found when there is a long right tail to the distribution and the mass of the distribution is concentrated to the left. Negative skew is found when there is a long left tail to the distribution and the mass of the distribution is concentrated to the right. We can usually see skew in histograms. We can also calculate a skewness statistic and test if this is significantly different from zero.</p>
<p>Kurtosis is a measure of how much a distribution is concentrated about the mean. Kurtosis can be zero, positive, or negative. Zero kurtosis is found when a variable is normally distributed. Positive kurtosis is found when the mass of the distribution is concentrated about the mean and there are very few values far from the mean. Negative kurtosis is found when the mass of the distribution is concentrated in the tails of the distribution. We can usually see kurtosis in histograms. We can also calculate a kurtosis statistic and test if this is significantly different from zero.</p>
<p>The NiPN data quality toolkit provides an R language function called <code><a href="../reference/skewKurt.html">skewKurt()</a></code> that calculates skewness and kurtosis statistics and tests whether they differ significantly from zero. Here we apply the <code><a href="../reference/skewKurt.html">skewKurt()</a></code> function to the muac variable in the example dataset:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">svy</span>$<span class="no">muac</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = +0.0525   SE = 0.0828 z = 0.6348  p = 0.5256
#&gt; Kurtosis = -0.2412   SE = 0.1653 z = 1.4586  p = 0.1447</code></pre>
<p>There is positive skew and negative kurtosis. Neither is significantly different from zero.</p>
<p>Applying the <code><a href="../reference/skewKurt.html">skewKurt()</a></code> function to the <strong>haz</strong> variable in the example dataset:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">svy</span>$<span class="no">haz</span>)</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = +0.3074   SE = 0.0828 z = 3.7149  p = 0.0002
#&gt; Kurtosis = +0.2074   SE = 0.1653 z = 1.2545  p = 0.2097</code></pre>
<p>There is a positive skew and a positive kurtosis. The skew is significantly different from zero. The skew can be seen in the histogram:</p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">haz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="st">"scott"</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>Applying the <code><a href="../reference/skewKurt.html">skewKurt()</a></code> function to the <strong>waz</strong> variable in the example dataset:</p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">svy</span>$<span class="no">waz</span>)</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = -0.0128   SE = 0.0828 z = 0.1541  p = 0.8775
#&gt; Kurtosis = +0.1805   SE = 0.1653 z = 1.0919  p = 0.2749</code></pre>
<p>There is negative skew and positive kurtosis. Neither is significantly different from zero.</p>
<p>Applying the <code><a href="../reference/skewKurt.html">skewKurt()</a></code> function to the <strong>whz</strong> variable in the example dataset:</p>
<div class="sourceCode" id="cb34"><html><body><pre class="r"><span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = +0.0823   SE = 0.0828 z = 0.9946  p = 0.3199
#&gt; Kurtosis = +0.7528   SE = 0.1653 z = 4.5530  p = 0.0000</code></pre>
<p>There is a positive skew and a positive kurtosis. The kurtosis is significantly different from zero. The kurtosis can be seen on the histogram:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">svy</span>$<span class="no">whz</span>, <span class="kw">breaks</span> <span class="kw">=</span> <span class="st">"scott"</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>as the tall central columns that exceed the expected values shown by the overlaid normal distribution.</p>
<p>Skew and kurtosis are both used in SMART plausibility checks. Table below shows how skew and kurtosis statistics are applied by SMART.</p>
<table class="table table">
<caption>
The range of absolute values of skewness and kurtosis statistics that are applied by SMART (2015)
</caption>
<thead><tr>
<th style="text-align:center;">
Absolute value* of skewness / kurtosis
</th>
<th style="text-align:center;">
SMART Interpretation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
&lt; 0.2
</td>
<td style="text-align:center;">
Excellent
</td>
</tr>
<tr>
<td style="text-align:center;">
≥ 0.2 and &lt; 0.4
</td>
<td style="text-align:center;">
Good
</td>
</tr>
<tr>
<td style="text-align:center;">
≥ 0.6 and &lt; 0.6
</td>
<td style="text-align:center;">
Acceptable
</td>
</tr>
<tr>
<td style="text-align:center;">
≥ 0.6
</td>
<td style="text-align:center;">
Problematic
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup>*</sup> This is the value of a number ignoring its negative or positive sign.<br> The absolute value of -0.2412 is 0.2412. The absolute value of +0.2412 is also 0.2412.
</td>
</tr></tfoot>
</table>
<p>The <strong>whz</strong> variable in the example dataset is considered “problematic” according to this scheme because kurtosis is above 0.6.</p>
<p>Care should be exercised when using statistical significance tests to classify data as “problematic”. The use of thresholds and ranges for skew and kurtosis statistics is usually a better approach than relying on tests of statistical significance. Significance tests can be strongly affected by sample size. Small sample sizes can lead to tests missing large effects and large sample sizes can lead to tests identifying small effects as highly significant. If a distribution appears to be normal (i.e. has a symmetrical, or nearly symmetrical, “bell-shaped” distribution) then it is usually safe to assume normality and to use statistical procedures that assume normality.</p>
<p>It is important to remember that the normal distribution is a mathematical abstraction. There is nothing compelling the real world to conform to the normal distribution. The normal distribution has become reified:</p>
<blockquote>
Everyone is sure of this [the normal distribution] … experimentalists believe that it is a mathematical theorem, and the mathematicians that it is an experimentally determined fact.
<footer>
— Henri Poincaré (1912), Calcul des Probabilités
</footer>
</blockquote>
<p>The data we see may be representative of reality even when it fails tests for normality.</p>
<p>Tests for normality are useful when selecting statistical methods that rely on normality. They are less useful for determining data quality. If data follows a symmetrical, or nearly symmetrical, “bell-shaped” distribution then it will usually safe to use.</p>
</div>
<div id="deviation-from-normality" class="section level2">
<h2 class="hasAnchor">
<a href="#deviation-from-normality" class="anchor"></a>Deviation from normality</h2>
<p>Some anthropometric survey methods (e.g. SMART) use deviations from perfect normality as an indicator of poor data quality. This is not a sensible approach because deviations from normality are not necessarily due to poor quality data; they can be due to sampling a mixed population. This is easy to demonstrate with some simulated data.</p>
<p>We will assume that we have a population consisting of two groups:</p>
<p><strong>Group 1 :</strong> 75% of the population, mean = -0.48, sd = 0.87</p>
<p><strong>Group 2 :</strong> 25% of the population, mean = -1.04, sd = 1.10</p>
<p>and that we take a sample size = 1000 from the whole population. We can simulate this:</p>
<div class="sourceCode" id="cb37"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">0</span>)
<span class="no">g1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">750</span>, <span class="kw">mean</span> <span class="kw">=</span> -<span class="fl">0.48</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">0.87</span>)
<span class="no">g2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">250</span>, <span class="kw">mean</span> <span class="kw">=</span> -<span class="fl">1.04</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">1.11</span>)
<span class="no">g1g2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">g1</span>, <span class="no">g2</span>)</pre></body></html></div>
<p>The distributions in the two subgroups (<strong>g1</strong> and <strong>g2</strong>) are both normally distributed:</p>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">g1</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">g1</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">g1</span>)
<span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">g1</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-52-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-52-2.png" width="50%"></p>
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  g1
#&gt; W = 0.99725, p-value = 0.2411
#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = +0.1149   SE = 0.0893 z = 1.2867  p = 0.1982
#&gt; Kurtosis = -0.1869   SE = 0.1783 z = 1.0483  p = 0.2945</code></pre>
<div class="sourceCode" id="cb40"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">g2</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">g2</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">g2</span>)
<span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">g2</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-55-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-55-2.png" width="50%"></p>
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  g2
#&gt; W = 0.9947, p-value = 0.5363
#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = +0.0317   SE = 0.1540 z = 0.2058  p = 0.8369
#&gt; Kurtosis = -0.1282   SE = 0.3068 z = 0.4178  p = 0.6761</code></pre>
<p>but the distribution in the entire sample (<strong>g1g2</strong>) is not normal:</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="fu"><a href="../reference/histNormal.html">histNormal</a></span>(<span class="no">g1g2</span>)
<span class="fu"><a href="../reference/qqNormalPlot.html">qqNormalPlot</a></span>(<span class="no">g1g2</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span>(<span class="no">g1g2</span>)
<span class="fu"><a href="../reference/skewKurt.html">skewKurt</a></span>(<span class="no">g1g2</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-58-1.png" width="50%"><img src="ad_files/figure-html/unnamed-chunk-58-2.png" width="50%"></p>
<p>The <em>Shapiro-Wilk test of normality</em> returns:</p>
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  g1g2
#&gt; W = 0.99671, p-value = 0.03514</code></pre>
<p>There is statistically significant negative skew:</p>
<pre><code>#&gt; 
#&gt;  Skewness and kurtosis
#&gt; 
#&gt; Skewness = -0.1767   SE = 0.0773 z = 2.2851  p = 0.0223
#&gt; Kurtosis = +0.2894   SE = 0.1545 z = 1.8728  p = 0.0611</code></pre>
<p>There is, however, nothing wrong with the sample or with the data</p>
<p>The distribution in the entire sample (<strong>g1g2</strong>) is called a “mixture of Gaussians” (the term “Gaussian” refers to the normal distribution in this context).</p>
<p>We can see this mixture of Gaussians with:</p>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">g1</span>, <span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>),
     <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">0.5</span>), <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">""</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">""</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">g2</span>, <span class="kw">col</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span>), <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(-<span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">0.5</span>), <span class="kw">add</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span>(<span class="kw">main</span> <span class="kw">=</span> <span class="st">"Histogram of g1 and g2"</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"z-score"</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
<p>In this case the mixture was already known. There are a number of methods for revealing the underlying mixture when the components of the mixture are unknown. These techniques are not covered in this toolkit. We will, however, continue with an example in which the components of the mixture are suspected.</p>
<p>We expect to see small deviations from normality in most survey datasets. This will often be the case when a survey samples subjects over a wide area covering, for example, several agro-ecological zones, socio-economic groups, or ethnic groups. This will almost always be the case, particularly with large surveys such as DHS, MICS, and national SMART surveys.</p>
<p>Another reason for non-normality is that one (or more) of the survey teams has a systematic bias in making a measurement. Identifying the “offending” survey team by examining and testing for normality separately in all combinations of data from <span class="math inline">\(n ~ – ~ 1\)</span> survey teams can be attempted. If (e.g.) there were three teams then we would need to separately test data from:</p>
<p>Team 1 and Team 2 (Team 3 excluded)</p>
<p>Team 1 and Team 3 (Team 2 excluded)</p>
<p>Team 2 and Team 3 (Team 1 excluded)</p>
<p>to see if the deviation from normality disappears when a particular team’s data are excluded. There is, however, a problem with this type of analysis. In cluster-sampled surveys, teams often sample adjacent primary sampling units (clusters). When this occurs the “exclude one team” analysis cannot distinguish between differences due to spatial heterogeneity (i.e. patchiness) and differences due to a team having a systematic measurement bias.</p>
</div>
<div id="the-standard-deviation-and-alternatives" class="section level2">
<h2 class="hasAnchor">
<a href="#the-standard-deviation-and-alternatives" class="anchor"></a>The standard deviation and alternatives</h2>
<p>The standard deviation is sometimes considered to be useful measure of data quality when applied to z-scores.</p>
<p>We can use the <strong>sd()</strong> function to find the standard deviation. For example:</p>
<div class="sourceCode" id="cb46"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; [1] 1.323469</code></pre>
<p>1.323469</p>
<p>This may produce misleading values if applied to raw data. This procedure should only be applied to cleaned data from which erroneous data and flagged records have been censored.</p>
<p>SMART guidelines state that the acceptable range for the standard deviation of the weight-for-height z-scores (<strong>whz</strong>) is 0.8 to 1.2 when flagging criteria have been applied and flagged records have been censored. Standard deviations outside this range are considered to indicate poor survey quality. Note that SMART does not define threshold for anthropometric indices other than weight-for-height z-scores. It is important to note that a standard deviation above 1.2 may be due to sampling from a mixed population rather than due to poor data quality.</p>
<p>The <strong>flag</strong> column in the example dataset contains a flagging code in which the codes <strong>2</strong>, <strong>3</strong>, <strong>6</strong>, or <strong>7</strong> indicate potential problems with weight and / or height. We should calculate the standard deviation of the <strong>whz</strong> variable using only the data in which records with these flagging codes are censored and there is no oedema recorded:</p>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="no">svy</span>$<span class="no">whz</span>[!(<span class="no">svy</span>$<span class="no">flag</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">7</span>) <span class="kw">|</span> <span class="no">svy</span>$<span class="no">oedema</span> <span class="kw">==</span> <span class="fl">1</span>)])</pre></body></html></div>
<p>The <code>!</code> character specifies a logical “not”. The standard deviation is, therefore, calculated using records in which the <strong>flag</strong> variable does <strong>not</strong> contain <strong>2</strong>, <strong>3</strong>, <strong>6</strong>, or <strong>7</strong> or oedema is <strong>not</strong> recorded as being present.</p>
<p>The standard deviation for <strong>whz</strong> when flagged records and oedema cases are censored is:</p>
<pre><code>#&gt; [1] 1.141944</code></pre>
<p>This is within the SMART acceptable range of 0.8 to 1.2.</p>
<p>The problem with using the standard deviation with raw data is that it is a non-robust statistic. This means that it can be strongly influenced by outliers. For example:</p>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.55</span>, <span class="fl">5.93</span>, <span class="fl">2.68</span>, <span class="fl">5.61</span>, <span class="fl">3.53</span>, <span class="fl">4.78</span>, <span class="fl">3.60</span>, <span class="fl">5.82</span>, <span class="fl">4.41</span>, <span class="fl">5.42</span>))</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; [1] 1.097533</code></pre>
<p>Adding a single outlier (e.g. data entered as <strong>7.84</strong> rather than as <strong>4.78</strong>):</p>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4.55</span>, <span class="fl">5.93</span>, <span class="fl">2.68</span>, <span class="fl">5.61</span>, <span class="fl">3.53</span>, <span class="fl">7.84</span>, <span class="fl">3.60</span>, <span class="fl">5.82</span>, <span class="fl">4.41</span>, <span class="fl">5.42</span>))</pre></body></html></div>
<p>returns:</p>
<pre><code>#&gt; [1] 1.496963</code></pre>
<p>In this example a single outlier has strongly influenced the standard deviation.</p>
<p>There are a number of robust estimators for the standard deviation. R provides the <code><a href="https://rdrr.io/r/stats/mad.html">mad()</a></code> function to calculate an adjusted <em>median absolute deviation</em> (MAD).</p>
<p>The median absolute deviation (MAD) is defined as the median of the absolute deviations from the median. It is the median of the absolute values of the differences between the individual data points and the median of the data:</p>
<p><span class="math display">\[ MAD ~ = ~ ( | x_i ~ - ~ median(x) | ) \]</span></p>
<p>The calculated MAD is adjusted to make it consistent with the standard deviation:</p>
<p><span class="math display">\[ \hat{\sigma} ~ = ~ k ~ \times ~ MAD  \]</span></p>
<p>where <em>k</em> is a constant scaling factor, which depends upon the distribution. For the normal distribution:</p>
<p><span class="math display">\[ k ~ = ~ 1.4826 \]</span></p>
<p>The <code><a href="https://rdrr.io/r/stats/mad.html">mad()</a></code> function in R function returns the adjusted MAD:</p>
<p><span class="math display">\[ \hat{\sigma} ~ = ~ 1.4826 ~ \times ~ MAD \]</span></p>
<p>This is a robust estimate of the standard deviation.</p>
<p>This estimator is preferred when a sample is taken from a mixed population (this is almost always the case) and when the distribution has “fat” or “heavy” tails, as is the case with the <strong>whz</strong> variable in the example dataset.</p>
<p>Using the <code><a href="https://rdrr.io/r/stats/mad.html">mad()</a></code> function with the raw WHZ data:</p>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span>(<span class="no">svy</span>$<span class="no">whz</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt; [1] 1.156428</code></pre>
<p>We would usually want to calculate the adjusted MAD of the whz variable using only the data in which records with flagging codes relevant to whz and cases of oedema are censored:</p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/mad.html">mad</a></span>(<span class="no">svy</span>$<span class="no">whz</span>[!(<span class="no">svy</span>$<span class="no">flag</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">7</span>) <span class="kw">|</span> <span class="no">svy</span>$<span class="no">oedema</span> <span class="kw">==</span> <span class="fl">1</span>)])</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt; [1] 1.097124</code></pre>
<p>The use of the standard deviation and robust equivalents such as the adjusted MAD with simple thresholds is problematic. Data that is a mixture of Gaussians distributions will tend to have large standard deviations even when there is no systematic error and nothing is wrong with the sample. Checks on the standard deviation in large surveys should, therefore, be performed on the smallest spatial strata above the PSU or cluster level. This reduces but does not eliminate the problem of sampling from mixed populations.</p>
<p>We will retrieve a dataset and examine within-strata MADs:</p>
<div class="sourceCode" id="cb58"><html><body><pre class="r"><span class="no">svy</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"flag.ex03.csv"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">","</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">svy</span>)</pre></body></html></div>
<pre><code>#&gt;   psu region state age sex weight height   haz   waz   whz
#&gt; 1   1     SE  Abia  12   2    7.4   72.1 -0.74 -1.58 -1.69
#&gt; 2   1     SE  Abia  33   1   13.3   94.2  0.04 -0.33 -0.52
#&gt; 3   1     SE  Abia  44   2   14.1   98.6 -0.41 -0.63 -0.57
#&gt; 4   1     SE  Abia  40   2   15.8   99.3  0.39  0.59  0.55
#&gt; 5   1     SE  Abia  23   2   10.1   83.9 -0.51 -0.90 -0.92
#&gt; 6   1     SE  Abia  24   1   13.9   88.7  0.52  1.18  1.22</code></pre>
<p>The file <strong>flag.ex03.csv</strong> is a comma-separated-value (CSV) file containing anthropometric data from a national SMART survey in Nigeria.</p>
<p>The data stored in the file flag.ex03.csv were collected using methods similar to MICS and DHS surveys. The only difference is that the survey concentrated on anthropometric data in children aged between 6 and 59 months. In this exercise we will concentrate on WHZ.</p>
<p>Data are stratified by <strong>region</strong> and by <strong>state</strong> within <strong>region</strong>. We will create a new variable that combines <strong>region</strong> and <strong>state</strong>:</p>
<div class="sourceCode" id="cb60"><html><body><pre class="r"><span class="no">svy</span>$<span class="no">regionState</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">svy</span>$<span class="no">region</span>, <span class="no">svy</span>$<span class="no">state</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">":"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">svy</span>)
<span class="co">#&gt;   psu region state age sex weight height   haz   waz   whz regionState</span>
<span class="co">#&gt; 1   1     SE  Abia  12   2    7.4   72.1 -0.74 -1.58 -1.69     SE:Abia</span>
<span class="co">#&gt; 2   1     SE  Abia  33   1   13.3   94.2  0.04 -0.33 -0.52     SE:Abia</span>
<span class="co">#&gt; 3   1     SE  Abia  44   2   14.1   98.6 -0.41 -0.63 -0.57     SE:Abia</span>
<span class="co">#&gt; 4   1     SE  Abia  40   2   15.8   99.3  0.39  0.59  0.55     SE:Abia</span>
<span class="co">#&gt; 5   1     SE  Abia  23   2   10.1   83.9 -0.51 -0.90 -0.92     SE:Abia</span>
<span class="co">#&gt; 6   1     SE  Abia  24   1   13.9   88.7  0.52  1.18  1.22     SE:Abia</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">regionState</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;       NC:Benue NC:FCT (Abuja)        NC:Kogi       NC:Kwara    NC:Nasarawa </span>
<span class="co">#&gt;            386            363            326            392            430 </span>
<span class="co">#&gt;       NC:Niger     NC:Plateau     NE:Adamawa      NE:Bauchi       NE:Borno </span>
<span class="co">#&gt;            589            503            410            804            558 </span>
<span class="co">#&gt;       NE:Gombe      NE:Taraba        NE:Yobe      NW:Jigawa      NW:Kaduna </span>
<span class="co">#&gt;            643            421            689            711            536 </span>
<span class="co">#&gt;        NW:Kano     NW:Katsina       NW:Kebbi      NW:Sokoto     NW:Zamfara </span>
<span class="co">#&gt;            671            657            728            646            668 </span>
<span class="co">#&gt;        SE:Abia     SE:Anambra      SE:Ebonyi       SE:Enugu         SE:Imo </span>
<span class="co">#&gt;            334            390            455            418            371 </span>
<span class="co">#&gt;   SS:Akwa-Ibom     SS:Bayelsa SS:Cross River       SS:Delta         SS:Edo </span>
<span class="co">#&gt;            331            330            376            346            480 </span>
<span class="co">#&gt;      SS:Rivers       SW:Ekiti       SW:Lagos        SW:Ogun        SW:Ondo </span>
<span class="co">#&gt;            315            376            640            566            426 </span>
<span class="co">#&gt;        SW:Osun         SW:Oyo </span>
<span class="co">#&gt;            435            610</span></pre></body></html></div>
<p>We can examine the adjusted MAD for <strong>whz</strong> for each combination of <strong>region</strong> and <strong>state</strong> in the survey dataset using:</p>
<div class="sourceCode" id="cb61"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span>(<span class="no">svy</span>$<span class="no">whz</span>, <span class="no">svy</span>$<span class="no">regionState</span>, <span class="no">mad</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; svy$regionState: NC:Benue</span>
<span class="co">#&gt; [1] 0.941451</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NC:FCT (Abuja)</span>
<span class="co">#&gt; [1] 0.96369</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NC:Kogi</span>
<span class="co">#&gt; [1] 0.993342</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NC:Kwara</span>
<span class="co">#&gt; [1] 0.993342</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NC:Nasarawa</span>
<span class="co">#&gt; [1] 0.926625</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NC:Niger</span>
<span class="co">#&gt; [1] 0.978516</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NC:Plateau</span>
<span class="co">#&gt; [1] 1.022994</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NE:Adamawa</span>
<span class="co">#&gt; [1] 1.045233</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NE:Bauchi</span>
<span class="co">#&gt; [1] 1.18608</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NE:Borno</span>
<span class="co">#&gt; [1] 1.030407</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NE:Gombe</span>
<span class="co">#&gt; [1] 1.082298</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NE:Taraba</span>
<span class="co">#&gt; [1] 1.008168</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NE:Yobe</span>
<span class="co">#&gt; [1] 1.022994</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Jigawa</span>
<span class="co">#&gt; [1] 1.200906</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Kaduna</span>
<span class="co">#&gt; [1] 0.985929</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Kano</span>
<span class="co">#&gt; [1] 1.156428</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Katsina</span>
<span class="co">#&gt; [1] 1.022994</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Kebbi</span>
<span class="co">#&gt; [1] 0.926625</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Sokoto</span>
<span class="co">#&gt; [1] 0.926625</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: NW:Zamfara</span>
<span class="co">#&gt; [1] 1.052646</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SE:Abia</span>
<span class="co">#&gt; [1] 0.904386</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SE:Anambra</span>
<span class="co">#&gt; [1] 0.926625</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SE:Ebonyi</span>
<span class="co">#&gt; [1] 0.904386</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SE:Enugu</span>
<span class="co">#&gt; [1] 0.919212</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SE:Imo</span>
<span class="co">#&gt; [1] 0.88956</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SS:Akwa-Ibom</span>
<span class="co">#&gt; [1] 0.904386</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SS:Bayelsa</span>
<span class="co">#&gt; [1] 1.11195</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SS:Cross River</span>
<span class="co">#&gt; [1] 0.971103</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SS:Delta</span>
<span class="co">#&gt; [1] 0.971103</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SS:Edo</span>
<span class="co">#&gt; [1] 0.971103</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SS:Rivers</span>
<span class="co">#&gt; [1] 1.052646</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SW:Ekiti</span>
<span class="co">#&gt; [1] 1.030407</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SW:Lagos</span>
<span class="co">#&gt; [1] 0.837669</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SW:Ogun</span>
<span class="co">#&gt; [1] 0.911799</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SW:Ondo</span>
<span class="co">#&gt; [1] 0.978516</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SW:Osun</span>
<span class="co">#&gt; [1] 0.904386</span>
<span class="co">#&gt; ------------------------------------------------------------ </span>
<span class="co">#&gt; svy$regionState: SW:Oyo</span>
<span class="co">#&gt; [1] 0.956277</span></pre></body></html></div>
<p>The long output can be made more compact, easier to read, and easier to work with:</p>
<div class="sourceCode" id="cb62"><html><body><pre class="r"><span class="no">mads</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span>(<span class="no">svy</span>$<span class="no">whz</span>, <span class="no">svy</span>$<span class="no">regionState</span>, <span class="no">mad</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">mads</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">mads</span>[<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">mads</span>)], <span class="fl">2</span>)
<span class="no">mads</span>
<span class="co">#&gt; svy$regionState</span>
<span class="co">#&gt;       NC:Benue NC:FCT (Abuja)        NC:Kogi       NC:Kwara    NC:Nasarawa </span>
<span class="co">#&gt;           0.94           0.96           0.99           0.99           0.93 </span>
<span class="co">#&gt;       NC:Niger     NC:Plateau     NE:Adamawa      NE:Bauchi       NE:Borno </span>
<span class="co">#&gt;           0.98           1.02           1.05           1.19           1.03 </span>
<span class="co">#&gt;       NE:Gombe      NE:Taraba        NE:Yobe      NW:Jigawa      NW:Kaduna </span>
<span class="co">#&gt;           1.08           1.01           1.02           1.20           0.99 </span>
<span class="co">#&gt;        NW:Kano     NW:Katsina       NW:Kebbi      NW:Sokoto     NW:Zamfara </span>
<span class="co">#&gt;           1.16           1.02           0.93           0.93           1.05 </span>
<span class="co">#&gt;        SE:Abia     SE:Anambra      SE:Ebonyi       SE:Enugu         SE:Imo </span>
<span class="co">#&gt;           0.90           0.93           0.90           0.92           0.89 </span>
<span class="co">#&gt;   SS:Akwa-Ibom     SS:Bayelsa SS:Cross River       SS:Delta         SS:Edo </span>
<span class="co">#&gt;           0.90           1.11           0.97           0.97           0.97 </span>
<span class="co">#&gt;      SS:Rivers       SW:Ekiti       SW:Lagos        SW:Ogun        SW:Ondo </span>
<span class="co">#&gt;           1.05           1.03           0.84           0.91           0.98 </span>
<span class="co">#&gt;        SW:Osun         SW:Oyo </span>
<span class="co">#&gt;           0.90           0.96</span></pre></body></html></div>
<p>The saved <strong>mads</strong> object can be summarised:</p>
<div class="sourceCode" id="cb63"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mads</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.8400  0.9300  0.9800  0.9892  1.0300  1.2000</code></pre>
<p>A table can also be useful:</p>
<div class="sourceCode" id="cb65"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">mads</span>)
<span class="co">#&gt; mads</span>
<span class="co">#&gt; 0.84 0.89  0.9 0.91 0.92 0.93 0.94 0.96 0.97 0.98 0.99 1.01 1.02 1.03 1.05 1.08 </span>
<span class="co">#&gt;    1    1    4    1    1    4    1    2    3    2    3    1    3    2    3    1 </span>
<span class="co">#&gt; 1.11 1.16 1.19  1.2 </span>
<span class="co">#&gt;    1    1    1    1</span></pre></body></html></div>
<p>In this example the adjusted MAD of the <strong>whz</strong> variable is within the limits 0.8 to 1.2 for all combinations of <strong>region</strong> and <strong>state</strong>.</p>
<p>Note that we combined <strong>region</strong> and <strong>state</strong>. We did this to avoid potential problems with duplicate <strong>state</strong> names (i.e. the same <strong>state</strong> name used in more than one <strong>region</strong>).</p>
<p>In the previous exercise we used the raw (i.e. without flagging) data. It is better to use only the data in which records with flagging codes relevant to <strong>whz</strong> and cases of oedema are censored.</p>
<p>This is a national SMART survey so we will use SMART flagging criteria. We will use the <code><a href="../reference/national.SMART.html">national.SMART()</a></code> function to add SMART flags to the survey dataset:</p>
<div class="sourceCode" id="cb66"><html><body><pre class="r"><span class="no">svyFlagged</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/national.SMART.html">national.SMART</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">svy</span>, <span class="kw">strata</span> <span class="kw">=</span> <span class="st">"regionState"</span>)</pre></body></html></div>
<p>We need to exclude records with flagging codes relevant to whz:</p>
<div class="sourceCode" id="cb67"><html><body><pre class="r"><span class="no">svyFlagged</span> <span class="kw">&lt;-</span> <span class="no">svyFlagged</span>[!(<span class="no">svyFlagged</span>$<span class="no">flagSMART</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">7</span>)), ]</pre></body></html></div>
<p>Note that oedema is not recorded in the dataset so we cannot exclude oedema cases.</p>
<p>We can now calculate the MAD for <strong>whz</strong> in each stratum:</p>
<div class="sourceCode" id="cb68"><html><body><pre class="r"><span class="no">mads</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span>(<span class="no">svyFlagged</span>$<span class="no">whz</span>, <span class="no">svyFlagged</span>$<span class="no">regionState</span>, <span class="no">mad</span>, <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">mads</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">mads</span>[<span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">mads</span>)], <span class="fl">2</span>)
<span class="no">mads</span>
<span class="co">#&gt; svyFlagged$regionState</span>
<span class="co">#&gt;       NC:Benue NC:FCT (Abuja)        NC:Kogi       NC:Kwara    NC:Nasarawa </span>
<span class="co">#&gt;           0.92           0.95           0.99           0.96           0.92 </span>
<span class="co">#&gt;       NC:Niger     NC:Plateau     NE:Adamawa      NE:Bauchi       NE:Borno </span>
<span class="co">#&gt;           0.93           1.02           1.02           1.17           1.02 </span>
<span class="co">#&gt;       NE:Gombe      NE:Taraba        NE:Yobe      NW:Jigawa      NW:Kaduna </span>
<span class="co">#&gt;           1.06           0.98           0.99           1.17           0.96 </span>
<span class="co">#&gt;        NW:Kano     NW:Katsina       NW:Kebbi      NW:Sokoto     NW:Zamfara </span>
<span class="co">#&gt;           1.10           1.01           0.90           0.90           1.02 </span>
<span class="co">#&gt;        SE:Abia     SE:Anambra      SE:Ebonyi       SE:Enugu         SE:Imo </span>
<span class="co">#&gt;           0.87           0.91           0.90           0.90           0.87 </span>
<span class="co">#&gt;   SS:Akwa-Ibom     SS:Bayelsa SS:Cross River       SS:Delta         SS:Edo </span>
<span class="co">#&gt;           0.87           1.05           0.92           0.95           0.96 </span>
<span class="co">#&gt;      SS:Rivers       SW:Ekiti       SW:Lagos        SW:Ogun        SW:Ondo </span>
<span class="co">#&gt;           1.01           1.01           0.85           0.90           0.96 </span>
<span class="co">#&gt;        SW:Osun         SW:Oyo </span>
<span class="co">#&gt;           0.89           0.95</span></pre></body></html></div>
<p>The saved <strong>mads</strong> object can be summarised:</p>
<div class="sourceCode" id="cb69"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mads</span>)</pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
#&gt;  0.8500  0.9000  0.9600  0.9665  1.0100  1.1700</code></pre>
<p>In this analysis the adjusted MAD of the <strong>whz</strong> variable is within the limits 0.8 to 1.2 for all combinations of <strong>region</strong> and <strong>state</strong>.</p>
</div>
<div id="measures-of-dispersion" class="section level2">
<h2 class="hasAnchor">
<a href="#measures-of-dispersion" class="anchor"></a>Measures of dispersion</h2>
<p>Measures of dispersion summarise how cases (e.g. children classified as wasted, stunted, or underweight) are distributed across a survey’s primary sampling units (e.g. clusters).</p>
<p>We will retrieve a survey dataset:</p>
<div class="sourceCode" id="cb71"><html><body><pre class="r"><span class="no">svy</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"flag.ex01.csv"</span>, <span class="kw">header</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">","</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">svy</span>)</pre></body></html></div>
<pre><code>#&gt;   psu child age sex weight height muac oedema   haz   waz   whz
#&gt; 1   1     1  20   2    6.1   82.5  127      2 -0.07 -4.54 -6.03
#&gt; 2   1     2  13   2    6.4   70.4  116      2 -1.83 -3.04 -2.93
#&gt; 3   1     3  15   1    7.1   67.5  124      2 -4.60 -3.34 -1.25
#&gt; 4   1     4  15   1    7.2   75.4  130      2 -1.48 -3.22 -3.57
#&gt; 5   1     5  15   1    7.4   70.0  124      2 -3.61 -2.99 -1.61
#&gt; 6   1     6  18   2    7.7   70.6  130      2 -3.48 -2.40 -0.82</code></pre>
<p>The file <strong>flag.ex01.csv</strong> is a comma-separated-value (CSV) file containing anthropometric data from a recent SMART survey in Sudan.</p>
<p>We will apply WHO flagging criteria to the data:</p>
<div class="sourceCode" id="cb73"><html><body><pre class="r"><span class="no">svy</span>$<span class="no">flag</span> <span class="kw">&lt;-</span> <span class="fl">0</span>
<span class="no">svy</span>$<span class="no">flag</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">svy</span>$<span class="no">haz</span>) <span class="kw">&amp;</span> (<span class="no">svy</span>$<span class="no">haz</span> <span class="kw">&lt;</span> -<span class="fl">6</span> <span class="kw">|</span> <span class="no">svy</span>$<span class="no">haz</span> <span class="kw">&gt;</span> <span class="fl">6</span>), <span class="no">svy</span>$<span class="no">flag</span> + <span class="fl">1</span>, <span class="no">svy</span>$<span class="no">flag</span>)
<span class="no">svy</span>$<span class="no">flag</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">svy</span>$<span class="no">whz</span>) <span class="kw">&amp;</span> (<span class="no">svy</span>$<span class="no">whz</span> <span class="kw">&lt;</span> -<span class="fl">5</span> <span class="kw">|</span> <span class="no">svy</span>$<span class="no">whz</span> <span class="kw">&gt;</span> <span class="fl">5</span>), <span class="no">svy</span>$<span class="no">flag</span> + <span class="fl">2</span>, <span class="no">svy</span>$<span class="no">flag</span>)
<span class="no">svy</span>$<span class="no">flag</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(!<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">svy</span>$<span class="no">waz</span>) <span class="kw">&amp;</span> (<span class="no">svy</span>$<span class="no">waz</span> <span class="kw">&lt;</span> -<span class="fl">6</span> <span class="kw">|</span> <span class="no">svy</span>$<span class="no">waz</span> <span class="kw">&gt;</span> <span class="fl">5</span>), <span class="no">svy</span>$<span class="no">flag</span> + <span class="fl">4</span>, <span class="no">svy</span>$<span class="no">flag</span>)</pre></body></html></div>
<p>We should exclude flagged records:</p>
<div class="sourceCode" id="cb74"><html><body><pre class="r"><span class="no">svy</span> <span class="kw">&lt;-</span> <span class="no">svy</span>[<span class="no">svy</span>$<span class="no">flag</span> <span class="kw">==</span> <span class="fl">0</span>, ]</pre></body></html></div>
<p>We will apply a case-definition for being stunted:</p>
<div class="sourceCode" id="cb75"><html><body><pre class="r"><span class="no">svy</span>$<span class="no">stunted</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">svy</span>$<span class="no">haz</span> <span class="kw">&lt;</span> -<span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>)</pre></body></html></div>
<p>We can examine the distribution of stunted cases across the primary sampling units in this survey:</p>
<div class="sourceCode" id="cb76"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">psu</span>, <span class="no">svy</span>$<span class="no">stunted</span>)
<span class="co">#&gt;     </span>
<span class="co">#&gt;       1  2</span>
<span class="co">#&gt;   1   8 20</span>
<span class="co">#&gt;   2  11 14</span>
<span class="co">#&gt;   3   7 22</span>
<span class="co">#&gt;   4   6 23</span>
<span class="co">#&gt;   5   7 15</span>
<span class="co">#&gt;   6  11 20</span>
<span class="co">#&gt;   7  11 14</span>
<span class="co">#&gt;   8  14 12</span>
<span class="co">#&gt;   9  12 18</span>
<span class="co">#&gt;   10 10  9</span>
<span class="co">#&gt;   11 12 16</span>
<span class="co">#&gt;   12  9 13</span>
<span class="co">#&gt;   13  9 13</span>
<span class="co">#&gt;   14  5 21</span>
<span class="co">#&gt;   15 12  9</span>
<span class="co">#&gt;   16  8 17</span>
<span class="co">#&gt;   17  6 23</span>
<span class="co">#&gt;   18  8 21</span>
<span class="co">#&gt;   19 10 12</span>
<span class="co">#&gt;   20  6 20</span>
<span class="co">#&gt;   21 11 18</span>
<span class="co">#&gt;   22 11 14</span>
<span class="co">#&gt;   23 12  6</span>
<span class="co">#&gt;   24  8 15</span>
<span class="co">#&gt;   25 10 19</span>
<span class="co">#&gt;   26 10  8</span>
<span class="co">#&gt;   27 12  9</span>
<span class="co">#&gt;   28  6 14</span>
<span class="co">#&gt;   29 14 10</span>
<span class="co">#&gt;   30 11 18</span></pre></body></html></div>
<p>We only need the counts of cases in each primary sampling unit:</p>
<div class="sourceCode" id="cb77"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">psu</span>, <span class="no">svy</span>$<span class="no">stunted</span>)[,<span class="fl">1</span>]
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 </span>
<span class="co">#&gt;  8 11  7  6  7 11 11 14 12 10 12  9  9  5 12  8  6  8 10  6 11 11 12  8 10 10 </span>
<span class="co">#&gt; 27 28 29 30 </span>
<span class="co">#&gt; 12  6 14 11</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">psu</span>, <span class="no">svy</span>$<span class="no">stunted</span>)[,<span class="fl">1</span>], <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"PSU"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Cases"</span>, <span class="kw">cex.names</span> <span class="kw">=</span> <span class="fl">0.5</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-93-1.png" width="70%" style="display: block; margin: auto;"></p>
<p>It will be useful to keep this for later use:</p>
<div class="sourceCode" id="cb78"><html><body><pre class="r"><span class="no">casesPerPSU</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">psu</span>, <span class="no">svy</span>$<span class="no">stunted</span>)[,<span class="fl">1</span>]
<span class="no">casesPerPSU</span>
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 </span>
<span class="co">#&gt;  8 11  7  6  7 11 11 14 12 10 12  9  9  5 12  8  6  8 10  6 11 11 12  8 10 10 </span>
<span class="co">#&gt; 27 28 29 30 </span>
<span class="co">#&gt; 12  6 14 11</span></pre></body></html></div>
<p>We are interested in how cases are distributed across the primary sampling units.</p>
<p>There are three general patterns. These are <em>random</em>, <em>clumped</em>, and <em>uniform</em>.</p>
<p>We can identify the pattern to which the example data most likely belongs using an <em>index of dispersion</em>.</p>
<p>The simplest index of dispersion, and the one used by SMART, is the <em>variance to mean ratio</em>:</p>
<p><span class="math display">\[ \text{Variance to mean ratio} ~ = ~ \frac{s ^ 2}{\overline{\chi}} \]</span></p>
<p>The interpretation of the variance to mean ratio is straightforward:</p>
<p>Variance to mean ratio ≈ 1 Random</p>
<p>Variance to mean ratio &gt; 1 Clumped (i.e. more clumped than random)</p>
<p>Variance to mean ratio &lt; 1 Uniform (i.e. more uniform than random)</p>
<p>The value of the variance to mean ratio can range between zero (maximum uniformity) and the total number of cases in the data (maximum clumping). Maximum uniformity is found when the same number of cases are found in every primary sampling unit. Maximum clumping is found when all cases are found in one primary sampling unit.</p>
<p>With the example data:</p>
<div class="sourceCode" id="cb79"><html><body><pre class="r"><span class="no">varianceCasesPerPSU</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">casesPerPSU</span>)
<span class="no">meanCasesPerPSU</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">casesPerPSU</span>) / <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">casesPerPSU</span>)
<span class="no">V2M</span> <span class="kw">&lt;-</span> <span class="no">varianceCasesPerPSU</span> / <span class="no">meanCasesPerPSU</span>
<span class="no">V2M</span>
<span class="co">#&gt; [1] 0.6393127</span></pre></body></html></div>
<p>The observed variance to mean ratio (<strong>0.6393127</strong>) suggests that the distribution of cases across primary sampling units is not completely uniform, but neither is it random.</p>
<p>A formal (<em>Chi-squared</em>) test can be performed. The Chi-squared test statistic can be calculated using:</p>
<div class="sourceCode" id="cb80"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>((<span class="no">casesPerPSU</span> - <span class="no">meanCasesPerPSU</span>)^<span class="fl">2</span>) / <span class="no">meanCasesPerPSU</span></pre></body></html></div>
<p>This returns:</p>
<pre><code>#&gt; [1] 18.54007</code></pre>
<p>18.54007</p>
<p>The critical values for this test statistic can be found using:</p>
<div class="sourceCode" id="cb82"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">casesPerPSU</span>) - <span class="fl">1</span>)</pre></body></html></div>
<p>This returns:</p>
<div class="sourceCode" id="cb83"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">qchisq</a></span>(<span class="kw">p</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="kw">df</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">casesPerPSU</span>) - <span class="fl">1</span>)</pre></body></html></div>
<p>16.04707 45.72229</p>
<p>If the Chi-squared test statistic was below <strong>16.04707</strong> then we would conclude that the pattern of cases across primary sampling units in the example data is uniform. This is not the case in the example data.</p>
<p>If the Chi-squared test statistic was above <strong>45.72229</strong> then we would conclude that the pattern of cases across primary sampling units in the example data is clumped. This is not the case in the example data.</p>
<p>Since the Chi-squared test statistic falls between <strong>16.04707</strong> and <strong>45.72229</strong> we conclude that the pattern of cases across primary sampling units in the example data is random.</p>
<p>There are problems with the variance to mean ratio. Some clearly non-random patterns can produce variance to mean ratios of one. The variance to mean ratio is also strongly influenced by the total number of cases present in the data when clumping is present.</p>
<p>A better measure is <em>Green’s Index of Dispersion</em>:</p>
<p><span class="math display">\[ \text{Green's Index} ~ = ~  \frac{ \left ( \frac{s ^ 2}{\overline{\chi}} \right ) ~ - ~ 1}{n ~ - ~ 1} \]</span></p>
<p>Green’s Index corrects the variance to mean ratio for the total number of cases present in the data.</p>
<p>The value of Green’s Index can range between $ -1 / (n - 1) $ for maximum uniformity (specific to the dataset) and one for maximum clumping. The interpretation of Green’s Index is straightforward:</p>
<p>Green’s Index ≈ 0 Random</p>
<p>Green’s Index &gt; 0 Clumped (i.e. more clumped than random)</p>
<p>Green’s Index &lt; 0 Uniform (i.e. more uniform than random)</p>
<p>The sampling distribution of Green’s Index is not well described. The NiPN data quality toolkit provides the <code>greenIndex()</code> function that overcomes this problem. This R language function uses the bootstrap technique to estimate Green’s Index and test whether the distribution of cases across primary sampling units is random.</p>
<p>The <code>greenIndex()</code> function requires you to specify the name of the survey dataset, the name of the variable specifying the primary sampling unit, and the name of the variable specifying case status. With the example data:</p>
<div class="sourceCode" id="cb84"><html><body><pre class="r"><span class="fu"><a href="../reference/greensIndex.html">greensIndex</a></span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">svy</span>, <span class="kw">psu</span> <span class="kw">=</span> <span class="st">"psu"</span>, <span class="kw">case</span> <span class="kw">=</span> <span class="st">"stunted"</span>)</pre></body></html></div>
<p>this returns:</p>
<pre><code>#&gt; 
#&gt;  Green's Index of Dispersion
#&gt; 
#&gt; Green's Index (GI) of Dispersion  = -0.0014, 95% CI = (-0.0021, -0.0005)
#&gt; Maximum uniformity for this data  = -0.0035
#&gt;                          p-value  =  0.0030</code></pre>
<p>The point estimate of Green’s Index (<strong>-0.0013</strong>) is below zero and the p-value of the test for a random distribution of cases across primary sampling units (<strong>0.0040</strong>) is below 0.05. The distribution of cases across primary sampling units in the example data is significantly more uniform than it is random. We can see this graphically using:</p>
<div class="sourceCode" id="cb86"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">psu</span>, <span class="no">svy</span>$<span class="no">stunted</span>)[,<span class="fl">1</span>]
<span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 </span>
<span class="co">#&gt;  8 11  7  6  7 11 11 14 12 10 12  9  9  5 12  8  6  8 10  6 11 11 12  8 10 10 </span>
<span class="co">#&gt; 27 28 29 30 </span>
<span class="co">#&gt; 12  6 14 11</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">svy</span>$<span class="no">psu</span>, <span class="no">svy</span>$<span class="no">stunted</span>)[,<span class="fl">1</span>], <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"PSU"</span>, <span class="kw">ylab</span> <span class="kw">=</span> <span class="st">"Cases"</span>, <span class="kw">cex.names</span> <span class="kw">=</span> <span class="fl">0.5</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">casesPerPSU</span>) / <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">casesPerPSU</span>), <span class="kw">lty</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="ad_files/figure-html/unnamed-chunk-102-1.png" width="700"></p>
<p>The dashed line on the plot marks the mean number of cases found in each primary sampling unit. A uniform distribution would show all bars ending close to this line (see figure above).</p>
<p>SMART uses the variance to mean ratio as a test of data quality. Green’s Index is a more robust choice because it can be used to compare samples that vary in overall sample size and the number of sampling units used.</p>
<p>The idea behind using a measure of dispersion to judge data quality is a belief that the distribution of cases of malnutrition across primary sampling units should always be random. If this is not the case then the data are considered to be suspect. The problem with this approach is that deviations from random can reflect the true distribution of cases in the survey area. This may occur when the survey area comprises, for example, more than one livelihood zone. It is also less likely to be the case for conditions, such as wasting and oedema, that are associated with infectious disease and so may be more clumped than randomly distributed across primary sampling units. This may become a particular problem when proximity sampling is used to collect the within-cluster samples.</p>
<p>Measures of dispersion are problematic when used as measures of data quality and should be interpreted with caution. The exception to this rule is finding maximum, or almost maximum, uniformity or maximum, or almost maximum, clumping. A finding of maximum uniformity is likely only when data have been fabricated. A finding of maximum clumping may indicate poor data collection and / or poor data management.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Mark Myatt, Ernest Guevarra.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
